# Знакомство:
VitaLabData - библиотека с совместными типами, между двумя проектами.

VitaLabAPI - backend на .AspNetCore.

VitaLabManager - клиентское приложение на WPF + MVVM.

## Подготовка к запуску
1. Клонировать репозиторий.
2. Открыть VitaLabAPI.sln, добавить проект VitaLabData в решение. Добавить ссылку VitaLabData в VitaLabAPI.
3. Открыть VitaLabManager, добавить проект VitaLabData в решение.  Добавить ссылку VitaLabData в VitaLabManager.
4. Запустить скрипт создания и заполнения базы данных VitalLabDbScript.sql, Используемая версия базы данных: MS SQL SERVER EXPRESS.
5. Зайти в VitaLabAPI appsettings.json и изменить ConnectionStrings" "MSSQL": "Data Source" на свой сервер (localhost может не работать из-за того, что я не знаю какая instance стоит на конечном компьютере sql express или ms sql server и также использовал систему авторизации windows (integrated security=true), если же стоит иная, стоит это прописать в строке подключения.

## Запуск
1. Запустить API.
2. Запустить VitaLabManager.
3. Авторизоваться с помощью тестовой учетной записи, которая уже автоматически введена (Login - Lucky, Password - 1234).

Под капотом: После успешной авторизации api отправляет bearer token, который содержит всю необходимую информацию для клиентского приложения (id пользователя, его роли в системе).
Слева будут доступные для этого пользователя вкладки, основанные на ролях пользователя.

### Пояснения:
**Проект не сложный, но очень объёмный**

Много чего было упущено и опущено с моей стороны, так как для меня, чтобы написать грамотный back-end и клиент нужно время, темболее на unit тесты.

Unit тесты опустил, чтобы успеть реализовать минимальный функционал, который к слову может быть с багами, так как времени на unit тесты было мало.

Написал пару unit тестов в VitaLabApi, чтобы показать живой пример, что для меня нету никаких проблем их писать.

### Проблемы о которых я осведомлён:
На моей машине работает, а на других? Нужно бы docker по хорошему и интеграционное тестирование.

Регистрации нету.

Накосячил с UserRole. Ближе к концу срока сдачи понял, что нужно было сделать не конкретные роли, которые что-то могут, а абстрактные роли, которые содержали бы в себе привелегии (CanRead, CanWrite, CanEdit и т.д.)

В роли loggera всё выводится в консоль при не ожиданных исключениях. Использовал бы любую бесплатную библиотеку с лицензией mit или apache для логгирования.

Не сделал UnitOfWork для репозитория, чтобы объединять запросы и отменять их в случае исключений и не нагружать api.

Для авторизации используется IdentityController в проекте VitaLabAPI, который по хорошему нужно извлечь на отдельный сервер Identity server.

VitaLabManager не имеет логера даже консольного и абсолютно не держит исключения, которые бы я ввёл однозначно будь у меня больше времени.

Нету таблицы данных под количество товара, ввёл бы отдельную таблицу склад или что-то подобное, где был бы номер продукта и его оставшееся кол-во.

Возможно нужно было бы объединить контроллеры Order и OrderData, в один, тут нужен был бы совет, кого-то поопытнее.

Возможно нужно было бы объединить контроллеры User и UserRoles, в один, тут нужен был бы совет, кого-то поопытнее.


### Улучшения которые я вижу:

Хранить строки подключения и ключ авторизации в secrets, не считаю это за проблему так как это еще не prod, а скорее alpha :).

Проекту по хорошему было бы ввести историю редакторования записей таблицы базы данных, кто и какое изменение ввёл.

Нету конкретного HttpClient у VitaLabManager, сделал бы обёртку, которая была бы заточена под запросы VitaLabAPI.

Можно было бы сделать базовый репозиторий в VitaLabAPI, который бы реализовал функционал Entity, которые имеют в себе общие свойства например: наличие свойства Id  будет означать, что все entity смогут реализовать эти методы - DeleteById, GetById и т.д., не знал как лучше реализовать и решил опустить этот момент.
